#include "exploit.h"

int main(int argc, char** argv)
{
	HANDLE hDriver = CreateFileA(DEVICE, GENERIC_READ | GENERIC_WRITE, 0, 0, OPEN_EXISTING, 0, 0);

	printf("[!] HackSysExtremeVulnerableDriver Uninitialized Stack Variable Exploit\n[!] Let's exploit!");

	if (hDriver == (HANDLE)-1)
	{
		printf("\n[-] Failed to obtain a driver handle. Handle Value: 0x%p, Error: %d (0x%x)", hDriver, GetLastError(), GetLastError());
		unused = getchar();
		return 1;
	}
	printf("\n[+] Obtained a driver handle. Handle Value: 0x%p", hDriver);

	return 0;
}